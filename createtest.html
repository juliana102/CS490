<!DOCTYPE html>
<html lang="en">
<head>
<title>Create Test</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" style="text/css" href="style.css">
<script src="functions.js"></script>
<script>

function formListener() {
  const searchSubmit = document.getElementById('login-form');


  searchSubmit.addEventListener('submit', (e) => {
    e.preventDefault();
    new FormData(searchSubmit);

  });


  saveSubmit.addEventListener('formdata', (e) => {
    let data = e.formData;
    console.log(data);

    var lst = document.getElementsByClassName("pts");
    for(i=0;i<lst.length;i++){
        var temp = document.getElementById(lst[i].id).value;
        data.append(lst[i].id, temp)
    }


      //temp.getElementsByTagName('b')[0].innerHTML = "Question ".concat(i+1);
    let req = new XMLHttpRequest();
    req.addEventListener( 'load', reqListener1 );
    req.open("POST", "https://web.njit.edu/~cc593/back/save.php");
    req.send(data);

  });


  searchSubmit.addEventListener('formdata', (e) => {
    let data = e.formData;
    let req = new XMLHttpRequest();
    req.addEventListener( 'load', reqListener );
    req.open("POST", "https://web.njit.edu/~cc593/mid/mid.php");
    req.responseType = 'json';
    req.send(data);
});

function reqListener1 () {
  console.log(this.response);
}

  function reqListener () {
    var list = this.response;
    console.log((list));
    for(i=0;i<list.length;i++){
      console.log(list[i]);
    }
    var table =fn(list);
    var el = document.getElementById("divtable");
    el.appendChild(table);
  }
}



function fn(list){
  var table = document.createElement('div');
  table.setAttribute('class', 'rTable');
  for (var i = 0; i < list.length; i++){
    var row = document.createElement('div');
    row.setAttribute('class', 'rTableRow');
    row.setAttribute('id', 'i'.concat(list[i]["id"]));
    row.setAttribute('draggable', 'true');
    row.setAttribute('ondragstart', 'drag(event)');

    var id = document.createElement('div');
    id.setAttribute('class', 'rTableCell');
    id.textContent = list[i]["id"];

    var diff = document.createElement('div');
    diff.setAttribute('class', 'rTableCell');
    diff.textContent = list[i]["diff"];
    diff.setAttribute('id', 'd'.concat(list[i]["id"]));


    var q = document.createElement('div');
    q.setAttribute('class', 'rTableCell');
    q.textContent = list[i]["question"];
    q.setAttribute('id', 'qi'.concat(list[i]["id"]));



    row.appendChild(id);
    row.appendChild(diff);
    row.appendChild(q);

    table.appendChild(row);
  }
  return table;
}
function allowDrop(ev) {
    ev.preventDefault();
}

function drag(ev) {
  console.log(ev);
    ev.dataTransfer.setData("text", ev.target.id);
    console.log(ev.target.id);
}

function drop(ev) {
    ev.preventDefault();
    var data = ev.dataTransfer.getData("text");
    console.log(data)
    var a = document.getElementById(data);
    document.getElementById(data).innerHTML="";

  }

function myFunction() {
  var dots = document.getElementById("dots");
  var moreText = document.getElementById("more");
  var btnText = document.getElementById("myBtn");

  if (dots.style.display === "none") {
    dots.style.display = "inline";
    btnText.innerHTML = "+ View Solution";
    moreText.style.display = "none";
  } else {
    dots.style.display = "none";
    btnText.innerHTML = "- View Solution";
    moreText.style.display = "inline";
  }
}
function changeSize() {
    var el = document.getElementById("test");
    el.style.height = "100px";
    el.style.width = "100px";
}
function myFunction1() {
  var itm = document.getElementsByTagName("div")[5];
  var drop = document.getElementById("target");
  console.log(itm);
  var cln = itm.cloneNode(true);
  var count = document.getElementsByClassName("card").length + 1;
  cln.setAttribute("id", "a".concat(count));
  cln.getElementsByTagName('span')[0].setAttribute("id", count);
  cln.getElementsByTagName('b')[0].innerHTML = "Question ".concat(count);
  drop.appendChild(cln);
  cln.getElementsByTagName('b')[0].innerHTML = "Question ".concat(count);


}

function removecard(clicked_id){
  document.getElementById("a".concat(clicked_id)).remove
  console.log(clicked_id);

}
function logOut(){
    console.log("Log out");
    window.localStorage.removeItem('username');
    window.localStorage.removeItem('type')
    window.location.replace('https://web.njit.edu/~jac323/index.php');
}


</script>

</head>
<ul>
  <li><a href="instructor.html">Home</a></li>
  <li><a class="active"href="createtest.html">Create Test</a></li>
  <li><a href="questions.html">Create Questions</a></li>
  <li><a href="grade.html">Grade Tests</a></li>
  <li><a href="javascript:logOut()">Logout</a></li>
</ul>
<body onload="formListener()">
<div class="row">
  <div class="column left">
</div>



  <div class="column middle">
    <h2>Exams</h2>
    <p> Add questions to this exam by dragging them over from the test bank.</p>
    <div class="cards">
      <form action="" method="" id="save">
        <div id="target" ondrop="drop(event)" ondragover="allowDrop(event)">
          <div class="newcard">
            <div class="card shadow">
              <div id="myModal" class="modal">
              <span id="1" onclick="removecard(this.id)">&times;</span>
            </div>
              <header class="w3-light-grey top" >
                <b id="htext">Question 1</b> <input type="text" class="pts" id="points" placeholder="Points" size="3" style="text-align:center"/>
              </header>
              <div class="content">
            <p id="">Write a function named not_string that takes argument str and adds 'not' to the front of the given string, unless the string already begins with 'not' then return the string unchanged.
            <span id="dots"></span><span id="more">def not_string(str): if len(str)>=3 and str[:3]=='not': return str return 'not'+str</span>
            </p>
          </div>
        <button class="button block w3-dark-grey" id="myBtn" onclick="myFunction()">+ View Solution</button>
      </div>

      <div class="space">
        </div>
      </div>
        </div>
      <button onclick="myFunction1()"> Save </button>
      </form>
    </div>
  </div>

  <div class="column right" id="test">
    <div>
    <form action="" method="" id="example-form">
        <div class="search">
          <input type="hidden" name="reqid" value="1"/>
          <label for="dif"> Key </label>
          <input type="text" name="key" id="key" placeholder="Search" onkeyup="AnotherOne()"/>

        </div>
        <!-- <div class="search">
          <label for="id"> ID</label>

          <input type="text" name="id" id="key" placeholder="Search"/>

        </div> -->
        <div class="search">

          <label for="dflag"> Difficulty: </label>
          <select id="dflag" name="dflag" onchange="selectThree()">
              <option value="">Select</option>
              <option value="easy">Easy</option>
              <option value="medium">Medium</option>
              <option value="hard">Hard</option>

              </select>
        </div>
        <div class="search">
          <label for="tflag"> Topic: </label>
          <select id="tflag" name="tflag" onchange="selectFour()">
                <option value="">Select</option>
                <option value="arrays">Arrays</option>
                <option value="strings">Strings</option>
                <option value="conditionals">Conditionals</option>
                <option value="loops">Loops</option>
                <option value="functions">Functions</option>


                </select>
        </div>

      <!-- <button type="submit"> Submit </button> -->
    </form>
    <div id="divtable">
    <div class="rTable">
    <div class="rTableRow">
      <div class="rTableHead"><strong>Topic</strong></div>
      <div class="rTableHead"><strong>Difficulty</strong></div>
      <div class="rTableHead"><strong>Question</strong></div>
    </div>
    <div class="rTableRow" id="draggable2" class="draggable" draggable="true" ondragstart="drag(event)">
        <div class="rTableCell">Strings</div>
        <div class="rTableCell">Medium</div>
        <div class="rTableCell">Write a function named not_string that takes argument str and adds 'not' to the front of the given string, unless the string already begins with 'not' then return the string unchanged.</div>
    </div>
    <div class="rTableRow" id="draggable3" class="draggable" draggable="true" ondragstart="drag(event)">
        <div class="rTableCell">Conditionals</div>
        <div class="rTableCell">Easy</div>
        <div class="rTableCell">Write a function named hello_there that takes parameters a_hello and b_hello that returns true if both a and b are saying hello or if neither of them are. Return false otherwise.</div>
    </div>
    <div class="rTableRow" id="draggable4" class="draggable" draggable="true" ondragstart="drag(event)">
      <div class="rTableCell">Functions</div>
      <div class="rTableCell">Easy</div>
      <div class="rTableCell">Write a function named sum that takes arguments x,y and returns the sum of two numbers.</div>
    </div>
    <div class="rTableRow" id="draggable5" class="draggable" draggable="true" ondragstart="drag(event)">
      <div class="rTableCell">Loops</div>
      <div class="rTableCell">Medium</div>
      <div class="rTableCell">Write a function named count that takes two arguments sequence and item that returns the number of times the item occurs in the list.</div>
    </div>
    <div class="rTableRow" id="draggable6" class="draggable" draggable="true" ondragstart="drag(event)">
      <div class="rTableCell">Functions</div>
      <div class="rTableCell">Easy</div>
      <div class="rTableCell">Write a function named mult that takes parameters a,b,c and prints the product of those three numbers.</div>
    </div>
    <div class="rTableRow" id="draggable7" class="draggable" draggable="true" ondragstart="drag(event)">
      <div class="rTableCell">Strings</div>
      <div class="rTableCell">Hard</div>
      <div class="rTableCell">Write a function named appendMiddle that takes arguments s1 and s2 and creates a new string by appending s2 in the middle of s1.Then prints that new string.</div>
    </div>
    <div class="rTableRow" id="draggable8" class="draggable" draggable="true" ondragstart="drag(event)">
      <div class="rTableCell">Strings</div>
      <div class="rTableCell">Hard</div>
      <div class="rTableCell">Write a function named findAll that takes an input string as its argument and counts all lowercase,uppercase,digits,and special symbols.Then prints the counts.</div>
    </div>
    <div class="rTableRow" id="draggable10" class="draggable" draggable="true" ondragstart="drag(event)">
      <div class="rTableCell">Loops</div>
      <div class="rTableCell">Hard</div>
      <div class="rTableCell">Wrtie a function called digit_sum that takes a positive integer n as input and returns the sum of all that number's digits.</div>
    </div>
    <div class="rTableRow" id="draggable11" class="draggable" draggable="true" ondragstart="drag(event)">
      <div class="rTableCell">Loops</div>
      <div class="rTableCell">Hard</div>
      <div class="rTableCell">Write a function named factorial that takes a non-negative integer x that can multiply all the integers from 1 through x,then returns it.</div>
    </div>
    </div>
    </div>

  </div>
</div>
</div>



<div class="footer">
</div>


</body>
</html>
